<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Productos - Gestión de Inventarios</title>
    <link rel="stylesheet" href="css/productos.css">
</head>
<body>
<header>
    <h1>Productos</h1>
    <nav class="menu">
        <button onclick="location.href='index.html'">Dashboard</button>
    </nav>
</header>

<section>
    <form id="formProducto">
        <input type="text" name="nombre" placeholder="Nombre" required>
        <input type="text" name="descripcion" placeholder="Descripción">
        <input type="number" name="precio" placeholder="Precio" min="0" step="0.01" required>
        <input type="number" name="stock" placeholder="Stock" min="0" required>
        <button type="submit">Agregar Producto</button>
    </form>

    <table id="tablaProductos">
        <thead>
        <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Precio</th>
            <th>Stock</th>
            <th>Acciones</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</section>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const tabla = document.querySelector("#tablaProductos tbody");
        const form = document.querySelector("#formProducto");
        let productos = JSON.parse(localStorage.getItem("productos")) || [];

        function guardar() {
            localStorage.setItem("productos", JSON.stringify(productos));
            cargarTabla();
        }

        function cargarTabla() {
            tabla.innerHTML = "";
            productos.forEach(p => {
                const fila = document.createElement("tr");
                fila.innerHTML = `
                <td>${p.id}</td>
                <td>${p.nombre}</td>
                <td>${p.descripcion}</td>
                <td>${p.precio.toFixed(2)}</td>
                <td>${p.stock}</td>
                <td>
                    <button class="eliminar" data-id="${p.id}">Eliminar</button>
                </td>
            `;
                tabla.appendChild(fila);
            });
        }

        form.addEventListener("submit", e => {
            e.preventDefault();
            const data = Object.fromEntries(new FormData(form));
            const id = productos.length > 0 ? productos[productos.length-1].id + 1 : 1;
            productos.push({
                id: id,
                nombre: data.nombre,
                descripcion: data.descripcion,
                precio: parseFloat(data.precio),
                stock: parseInt(data.stock),
                fecha: new Date()
            });
            guardar();
            form.reset();
        });

        tabla.addEventListener("click", e => {
            if(e.target.classList.contains("eliminar")){
                const id = parseInt(e.target.dataset.id);
                productos = productos.filter(p => p.id !== id);
                guardar();
            }
        });

        cargarTabla();
    });
</script>
</body>
</html>
