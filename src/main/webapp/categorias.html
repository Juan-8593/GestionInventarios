<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Categorías - Gestión de Inventarios</title>
    <link rel="stylesheet" href="css/categorias.css">
</head>
<body>
<header>
    <h1> Categorías</h1>
    <nav class="menu">
        <button onclick="location.href='index.html'">Dashboard</button>
        <button onclick="location.href='productos.html'">Productos</button>
        <button onclick="location.href='movimientos.html'">Movimientos</button>
    </nav>
</header>

<section>
    <form id="formCategoria">
        <input type="text" name="nombre" placeholder="Nombre de la categoría" required>
        <button type="submit">Agregar Categoría</button>
    </form>

    <table id="tablaCategorias">
        <thead>
        <tr>
            <th>ID</th>
            <th>Nombre</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</section>

<script>
    document.addEventListener("DOMContentLoaded",()=>{
        const tabla=document.querySelector("#tablaCategorias tbody");
        const form=document.querySelector("#formCategoria");

        function cargarCategorias(){
            fetch('categorias').then(r=>r.json()).then(data=>{
                tabla.innerHTML="";
                data.forEach(c=>{
                    const fila=document.createElement("tr");
                    fila.innerHTML=`<td>${c.id}</td><td>${c.nombre}</td>`;
                    tabla.appendChild(fila);
                });
            });
        }

        form.addEventListener("submit",e=>{
            e.preventDefault();
            const fd=new FormData(form);
            fetch('categorias',{method:'POST',body:new URLSearchParams(fd)})
                .then(r=>r.text()).then(msg=>{
                alert(msg);
                form.reset();
                cargarCategorias();
            });
        });

        cargarCategorias();
    });
</script>
</body>
</html>
